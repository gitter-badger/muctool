<!DOCTYPE html>
<!--
  ~ MUCtool Web Toolkit
  ~
  ~ Copyright 2017 Alexander Orlov <alexander.orlov@loxal.net>. All rights reserved.
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as published
  ~ by the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<html lang="en">
<script>
    const loadPageIntoContainer = function () {
        location.hash = location.pathname.substring(1, location.pathname.lastIndexOf(".html"));
        location.pathname = "";
    };
    loadPageIntoContainer();
</script>
<meta charset="utf-8">
<title>Simple Site Search</title>

<h1>Simple Site Search</h1>


<link rel="stylesheet" type="text/css" href="https://sitesearch.cloud/searchbar/css/app.css"/>
<link rel="stylesheet" type="text/css" href="https://sitesearch.cloud/theme/font/css/font-awesome.min.css"/>

<script>
    let serviceUrl;
    if (location.hostname === "localhost") {
        serviceUrl = "http://localhost:8001";
    } else {
        serviceUrl = "https://sitesearch.cloud";
    }
    const triggerFirstUsageOwnership = function (feedUrl) {
        const xhr = new XMLHttpRequest();
        xhr.open("PUT", serviceUrl + "/sites/rss?feedUrl=" + feedUrl);
        xhr.onload = function () {
            const tenantId = JSON.parse(this.response)["tenantId"];
            document.getElementById("tenantId").value = tenantId;
            document.cookie = "override-tenant = " + tenantId;
            document.getElementById("tenantSecret").value = JSON.parse(this.response)["tenantSecret"];
        };
        xhr.send();
    }
</script>

<style>
    label {
        font-weight: bold;
    }

    .wrapper {
        display: grid;
        grid-template-columns: 130px 400px;
    }

    label, input {
        font-weight: bold;
        border-radius: .1em;
        border: 2px;
    }

    label {
        font-weight: normal;
    }

    #index {
        text-align: center;
        font-weight: bold;
        width: 530px;
    }

    .if-teaser-highlight {
        font-weight: bold;
    }
</style>
<h1 style="font-size: 2em;"><span class="fa fa-search"></span> Simple Site Search</h1>
<div class="wrapper">
    <label for="feedUrl"><span class="fa fa-rss"></span> Feed URL</label>
    <input id="feedUrl" placeholder="Feed URL, e.g. https://intrafind.de/share/enterprise-search-blog.xml"
           value="https://streemian.com/rss/blockchain">
    <label for="email"><span class="fa fa-envelope-o"></span> E-mail</label>
    <input id="email" placeholder="E-mail" value="alexander.orlov@intrafind.de">
    <label for="tenantId"><span class="fa fa-key"></span> Tenant ID</label>
    <input id="tenantId" placeholder="Tenant ID">
    <label for="tenantSecret"><span class="fa fa-user-secret"></span> Tenant Secret</label>
    <input id="tenantSecret" placeholder="Tenant Secret">
</div>
<button id="index" class="fa fa-cogs"
        style="height: 1.5em; font-size: 2em;"
        onclick="triggerFirstUsageOwnership(document.getElementById('feedUrl').value)">
    Enable Search
</button>

<div class="container" style="margin-top:22px; width: 530px;">
    <div id="searchbar"></div>
    <div id="resultlist"></div>
</div>

<script src="https://sitesearch.cloud/searchbar/js/app.js"></script>
<script>
    jQuery.noConflict();
    jQuery(document).ready(function ($) {

        IFS.initClient({
            sbTarget: "#searchbar",
            configurl: "https://sitesearch.cloud/searchbar/data/sitesearch-config.json",
            sitesearch: true,
            tenantId: "eefb005b-7c2d-471a-baf7-b10e7c18b65b"
        });
    });
</script>

<iframe src="https://sitesearch.cloud/searchbar-gadget.html"></iframe>


