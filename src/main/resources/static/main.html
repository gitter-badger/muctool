<!DOCTYPE html>
<!--
  ~ Copyright 2017 Alexander Orlov <alexander.orlov@loxal.net>. All rights reserved.
  -->

<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#eef">
<meta name="keywords" content="MUCtool, Alexander Orlov, Simplicity, Flexibility, Whois">
<meta name="description" content="MUCtool Service">
<meta name="author" content="loxal - Alexander Orlov <alexander.orlov@loxal.net>">
<link rel="stylesheet" href="theme/winter.css" type="text/css">
<title>MUCTool | loxal</title>

<script>
    "use strict";

    const navTo = async function (hash) {
        location.hash = hash;
        const handlerMap = {
            '': '/home.html',
            '#whois': '/home.html',
            '#imprint': '/imprint.html'
        };
        if (!handlerMap[location.hash]) {
            document.getElementById('main').innerHTML = '<div class="info warn">Page Not Found</div>';
        } else {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', handlerMap[location.hash]);
            xhr.onload = function () {
                document.getElementById("main").innerHTML = this.responseText;
            };
            xhr.send();
        }
    };

    const applySiteProperties = async function () {
        const xhr = new XMLHttpRequest();
        xhr.open('GET', '/properties.json');
        xhr.onload = function () {
            const siteProperties = JSON.parse(this.responseText);
            document.getElementById('signature').innerHTML = siteProperties['year'] + ' ' + siteProperties['copyright'];
            document.getElementById('header-description').innerHTML = siteProperties['titleDesc'];
        };
        xhr.send();
    };

    const callWhois = async function () {
        let query;
        if (location.hostname === "localhost") {
            query = "?queryIP=185.17.205.98";
        } else {
            query = "";
        }
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "/whois/city" + query);
        xhr.onload = function () {
            console.dirxml(this.responseText);
            document.getElementById("whois").innerHTML = this.responseText;
            let whoisInfo = this.response;
            // TODO digest `whoisInfo`
        };
        xhr.send();
    };

    console.log("%c%s", "color: #ee1; background: #111; font-size: 2em; font-weight: bold; border-radius: 1em;", " Don't PanicðŸ˜Š")
</script>

<body onload="applySiteProperties(); navTo('#whois');">
<div id="header">
    <div id="header-title">
        <img id="logo" src="favicon.ico" alt="Logo" title="Logo"
             width="512" height="512" style="max-height: 96px; width: auto;"/>
        <a href="/#" id="title" title="Home">MUCtool</a>

        <div id="header-description"></div>
    </div>
    <div id="meta-ctrl">
        <!--<a id="auth">Login</a>-->
        <span id="user"></span>
    </div>
</div>

<div id="sidebar">
    <div id="index">
        <ul class="nav">
            <li>
                <a href="javascript:navTo('#whois');" title="Whois as a Service"><span class="fa fa-user-secret"></span>
                    Whois</a>
            </li>
            <li>
                <a href="https://github.com/loxal" title="OSS Craftsmanship"><span class="fa fa-github"></span>
                    GitHub</a>
            </li>
            <li>
                <a href="https://twitter.com/alexander_orlov" title="Thoughts"><span class="fa fa-twitter"></span>
                    Twitter</a>
            </li>
        </ul>
    </div>
</div>

<div id="main"></div>

<div id="footer">
    <p>
        <span>
            <a href="https://muctool.loxal.net" title="MUCtool">MUCtool</a> is carefully handcrafted with â™¥ in Munich
        </span>
        <span style="float: right;">
            <a href="javascript:navTo('#imprint');" title="Contact">Imprint</a>
            | &copy; <span id="signature"></span>
        </span>
    </p>
</div>